# üîÑ –ö–∞–∫ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Python Worker –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üìå –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å?

Python Worker –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å –ø–æ—Å–ª–µ:
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–∫—Å–∏ –¥–ª—è –∞–∫–∫–∞—É–Ω—Ç–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞ Python Service
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è environment variables

---

## üéØ –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ Timeweb Cloud –ø–∞–Ω–µ–ª—å (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://timeweb.cloud/my/apps
2. –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç

### –®–∞–≥ 2: –ù–∞–π–¥–∏—Ç–µ Python Worker
–ò—â–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º:
- `wemdio newai python worker`
- –ò–ª–∏ –ø–æ—Ö–æ–∂–µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å "python" –∏–ª–∏ "worker"

### –®–∞–≥ 3: –°–¥–µ–ª–∞–π—Ç–µ —Ä–µ–¥–µ–ø–ª–æ–π
1. **–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
2. **–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–†–µ–¥–µ–ø–ª–æ–π"** (Redeploy)
3. **–í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ç–∫—É**: `backend-deploy`
4. **–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–º–∏—Ç**: `5591374a` (–ø–æ—Å–ª–µ–¥–Ω–∏–π —Å proxy verification)
5. **–ù–∞–∂–º–∏—Ç–µ "–ó–∞–ø—É—Å—Ç–∏—Ç—å"**

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ –ª–æ–≥–∏ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

**‚úÖ –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—É—Å–∫:**
```
============================================================
ü§ñ AI Messaging Service
============================================================
Started at: 2025-11-18 XX:XX:XX UTC

üîß Initializing components...
‚úÖ Connected to Supabase (REST API)
‚úÖ All components initialized

============================================================
üîÑ Iteration #1 - XX:XX:XX UTC
============================================================
```

**‚úÖ –ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø—Ä–æ–∫—Å–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç—ã —Å –ø—Ä–æ–∫—Å–∏):**
```
üîß Processing session_string for Account Name
üîç Testing proxy connection: 1.2.3.4:1080
‚úÖ Proxy connection successful
‚úÖ Initialized account: Account Name (@username)
```

**‚ùå –ï—Å–ª–∏ –ø—Ä–æ–∫—Å–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```
üîç Testing proxy connection: 1.2.3.4:1080
‚ùå Proxy connection failed: Connection refused
‚ö†Ô∏è Marking account xxx as error: Proxy connection failed
```

---

## üöÄ –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ API/CLI (–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π)

–ï—Å–ª–∏ —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω Timeweb API token, –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API:

```bash
# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
curl -X GET "https://api.timeweb.cloud/api/v1/apps" \
  -H "Authorization: Bearer YOUR_TOKEN"

# –ù–∞–π—Ç–∏ ID Python Worker –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

# –°–¥–µ–ª–∞—Ç—å —Ä–µ–¥–µ–ø–ª–æ–π
curl -X POST "https://api.timeweb.cloud/api/v1/apps/{APP_ID}/deploy" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "commit_sha": "5591374a"
  }'
```

---

## üîß –°–ø–æ—Å–æ–± 3: –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ:

### 1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É Python Service
```bash
cd "C:\Users\wemd1\Desktop\new ai\backend\python-service"
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã)
```bash
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª
–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:
```env
SUPABASE_URL=https://vvopntdqtzqxdnktiqam.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
MAX_MESSAGES_PER_DAY=25
MESSAGE_DELAY_MIN=30
MESSAGE_DELAY_MAX=120
```

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Worker
```bash
python main.py
```

### 5. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Worker
–ù–∞–∂–º–∏—Ç–µ `Ctrl+C`

---

## üìä –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ?

1. **Worker –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è** - –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è
2. **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç—Å—è** - –Ω–æ–≤—ã–π –∫–æ–¥ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è —Å GitHub
3. **Worker –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è** - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
4. **–ê–∫–∫–∞—É–Ω—Ç—ã –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è** - –≤–∫–ª—é—á–∞—è –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–æ–∫—Å–∏
5. **–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–º–ø–∞–Ω–∏–π** - –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –ü—Ä–æ Session —Ñ–∞–π–ª—ã
Python Worker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `/tmp/sessions` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è session —Ñ–∞–π–ª–æ–≤.

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ session —Ñ–∞–π–ª—ã –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ—Ç–µ—Ä—è–Ω—ã.

**–†–µ—à–µ–Ω–∏–µ:** Worker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç session —Ñ–∞–π–ª—ã –∏–∑ `session_string` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

### –ü—Ä–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏
–ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ:
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ù–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞
- ‚ö†Ô∏è –ö–æ—Ä–æ—Ç–∫–∏–π –¥–∞—É–Ω—Ç–∞–π–º (~10-30 —Å–µ–∫—É–Ω–¥)

### –ü—Ä–æ –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–æ–∫—Å–∏
–ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ Worker:
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∞–∫–∫–∞—É–Ω—Ç—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –ø—Ä–æ–∫—Å–∏ (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
- –ü–æ–º–µ—á–∞–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã –∫–∞–∫ "error"
- –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã

---

## üêõ Troubleshooting

### Worker –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. Environment variables –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. SUPABASE_URL –∏ SUPABASE_ANON_KEY –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ
3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞
4. Dockerfile –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (`backend/Dockerfile.python-worker`)

### –ü—Ä–æ–∫—Å–∏ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è
**–ü—Ä–∏—á–∏–Ω—ã:**
1. Worker –µ—â–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω - –ø–æ–¥–æ–∂–¥–∏—Ç–µ 10-30 —Å–µ–∫—É–Ω–¥
2. –ê–∫–∫–∞—É–Ω—Ç —É–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω - –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Worker
3. –í –±–∞–∑–µ –Ω–µ—Ç `proxy_url` - –æ–±–Ω–æ–≤–∏—Ç–µ –∞–∫–∫–∞—É–Ω—Ç —á–µ—Ä–µ–∑ UI

### –ê–∫–∫–∞—É–Ω—Ç –≤ —Å—Ç–∞—Ç—É—Å–µ "error" –ø–æ—Å–ª–µ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ–∫—Å–∏
**–†–µ—à–µ–Ω–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø—Ä–æ–∫—Å–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø—Ä–æ–∫—Å–∏ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Telegram (149.154.175.53:443)
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –ø—Ä–æ–∫—Å–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç proxy URL

### –ö–∞–∫ –≤–µ—Ä–Ω—É—Ç—å –∞–∫–∫–∞—É–Ω—Ç –∏–∑ "error" –≤ "active"
**–í–∞—Ä–∏–∞–Ω—Ç 1 (—á–µ—Ä–µ–∑ UI):**
1. –û—Ç–∫—Ä–æ–π—Ç–µ AI –†–∞—Å—Å—ã–ª–∫–∏
2. –ù–∞–∂–º–∏—Ç–µ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–µ
3. –ò–∑–º–µ–Ω–∏—Ç–µ –∏–ª–∏ —É–¥–∞–ª–∏—Ç–µ –ø—Ä–æ–∫—Å–∏
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ
5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Worker

**–í–∞—Ä–∏–∞–Ω—Ç 2 (—á–µ—Ä–µ–∑ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö):**
```sql
UPDATE telegram_accounts 
SET status = 'active', is_available = true 
WHERE id = 'ACCOUNT_ID';
```

---

## üìû –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Python Worker –≤ Timeweb –ø–∞–Ω–µ–ª–∏
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –≤ UI (AI –†–∞—Å—Å—ã–ª–∫–∏)
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ `PROXY_VERIFICATION.md` –¥–ª—è –¥–µ—Ç–∞–ª–µ–π

