# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: Telegram Mini App Bot

## –ü—Ä–æ–±–ª–µ–º–∞
Menu Button –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`initData` –ø—É—Å—Ç–æ–π), –ø–æ—ç—Ç–æ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ Telegram –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ—Ç–∞ —Å Web App –∫–Ω–æ–ø–∫–æ–π –≤–º–µ—Å—Ç–æ Menu Button.

---

## üìã –®–∞–≥–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞

### 1Ô∏è‚É£ –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

–í Timeweb Cloud –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ –≤ `.env`:
```env
TELEGRAM_MINI_APP_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_botfather
```

### 2Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç–µ Mini App –±–æ—Ç–∞

**–õ–æ–∫–∞–ª—å–Ω–æ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):**
```bash
cd backend
npm run miniapp-bot
```

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (Timeweb Cloud):**

–î–æ–±–∞–≤—å—Ç–µ –∑–∞–ø—É—Å–∫ –≤ –≤–∞—à `docker-compose.yml` –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:

```yaml
services:
  miniapp-bot:
    build: .
    command: npm run miniapp-bot
    environment:
      - TELEGRAM_MINI_APP_BOT_TOKEN=${TELEGRAM_MINI_APP_BOT_TOKEN}
```

–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (–∏–∑ –ø–∞–ø–∫–∏ backend):
```bash
cd backend
node telegram-bot-mini-app.js
```

### 3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
‚úÖ Mini App Bot started
ü§ñ Bot is ready. Send /start to test.
```

### 4Ô∏è‚É£ –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram

1. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä `@polza_leads_bot`)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"üöÄ –û—Ç–∫—Ä—ã—Ç—å Lead Scanner"**

‚úÖ **Mini App –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—Ö–æ–¥–æ–º —á–µ—Ä–µ–∑ Telegram!**

---

## üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (Menu Button) ‚ùå
```
User ‚Üí Menu Button ‚Üí Mini App –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
‚ùå initData –ø—É—Å—Ç–æ–π ‚Üí –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ö–æ–¥–∞
```

### –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–± (Web App –∫–Ω–æ–ø–∫–∞) ‚úÖ
```
User ‚Üí /start ‚Üí Bot –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç inline –∫–Ω–æ–ø–∫—É ‚Üí User –Ω–∞–∂–∏–º–∞–µ—Ç
‚úÖ initData –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç!
```

---

## üéØ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –±–æ—Ç?

**–§–∞–π–ª:** `backend/telegram-bot-mini-app.js`

```javascript
// –ü—Ä–∏ /start –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å Web App –∫–Ω–æ–ø–∫–æ–π
bot.onText(/\/start/, (msg) => {
  bot.sendMessage(chatId, '–ü—Ä–∏–≤–µ—Ç! –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ...', {
    reply_markup: {
      inline_keyboard: [[
        {
          text: 'üöÄ –û—Ç–∫—Ä—ã—Ç—å Lead Scanner',
          web_app: { url: 'https://telegram-scanner.ru' }
        }
      ]]
    }
  });
});
```

**–í–∞–∂–Ω–æ:** `web_app` –∫–Ω–æ–ø–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç `initData` –≤ Mini App!

---

## üÜò Troubleshooting

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `TELEGRAM_MINI_APP_BOT_TOKEN` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—â–µ–Ω (`npm run miniapp-bot`)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

### Mini App –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π: `https://telegram-scanner.ru`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –¥–æ–º–µ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å URL –≤ –±—Ä–∞—É–∑–µ—Ä–µ

### –í—Å–µ –µ—â–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É –ª–æ–≥–∏–Ω–∞
–≠—Ç–æ –∑–Ω–∞—á–∏—Ç `initData` –≤—Å–µ –µ—â–µ –ø—É—Å—Ç–æ–π. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **–û—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ —á–µ—Ä–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–Ω–æ–ø–∫—É?**
   - ‚úÖ –ß–µ—Ä–µ–∑ inline –∫–Ω–æ–ø–∫—É –æ—Ç –±–æ—Ç–∞ (–ø–æ—Å–ª–µ /start)
   - ‚ùå –ß–µ—Ä–µ–∑ Menu Button

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏** (–µ—Å–ª–∏ –º–æ–∂–µ—Ç–µ):
   ```javascript
   console.log('initData:', tg.initData);
   console.log('user:', tg.initDataUnsafe.user);
   ```

---

## üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –æ—Å—Ç–∞–≤–∏—Ç—å email/password

–ï—Å–ª–∏ –±–æ—Ç —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å, –º–æ–∂–Ω–æ **–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π –≤–∞—Ä–∏–∞–Ω—Ç**:
- –í –±—Ä–∞—É–∑–µ—Ä–µ: email/password
- –í Telegram —á–µ—Ä–µ–∑ Menu Button: email/password

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Mini App, –ø—Ä–æ—Å—Ç–æ —Å –æ–±—ã—á–Ω—ã–º –≤—Ö–æ–¥–æ–º.

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

–î–ª—è **production** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–¥–≤–∞ —Å–ø–æ—Å–æ–±–∞**:
1. Web App –∫–Ω–æ–ø–∫–∞ (–¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥
2. Email/password (–¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) - –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç —á–µ—Ä–µ–∑ Menu Button

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞! üéâ

